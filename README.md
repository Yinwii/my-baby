# å®å®æˆé•¿è®°å½• Web åº”ç”¨

ä¸€ä¸ªåŸºäº Next.js 15 + React 19 + TypeScript + Tailwind CSS + Prismaæ„å»ºçš„ç°ä»£åŒ–å®å®æˆé•¿è®°å½•åº”ç”¨ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹è‰²

### ğŸ“Š æ•°æ®ç®¡ç†
- **å®å®ä¿¡æ¯ç®¡ç†**ï¼šè®°å½•å®å®çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå§“åã€å‡ºç”Ÿæ—¥æœŸã€æ€§åˆ«ã€è¡€å‹ç­‰ï¼‰
- **æˆé•¿è®°å½•è¿½è¸ª**ï¼šè®°å½•èº«é«˜ã€ä½“é‡ã€å¤´å›´ç­‰å…³é”®æˆé•¿æŒ‡æ ‡
- **é‡Œç¨‹ç¢‘è®°å½•**ï¼šè®°å½•å®å®çš„é‡è¦æˆé•¿é‡Œç¨‹ç¢‘å’Œç‰¹æ®Šæ—¶åˆ»
- **åª’ä½“ç›¸å†Œ**ï¼šæ”¯æŒç…§ç‰‡å’Œè§†é¢‘ä¸Šä¼ ï¼ŒåŒ…æ‹¬HEICæ ¼å¼è‡ªåŠ¨è½¬æ¢

### ğŸ“ˆ å¯è§†åŒ–å›¾è¡¨
- **æˆé•¿æ›²çº¿å›¾**ï¼šä½¿ç”¨ Recharts å±•ç¤ºå®å®çš„æˆé•¿è¶‹åŠ¿
- **æ•°æ®ç»Ÿè®¡**ï¼šæ˜¾ç¤ºè®°å½•å¤©æ•°ã€æœ€æ–°è®°å½•ç­‰ç»Ÿè®¡ä¿¡æ¯
- **äº¤äº’å¼å›¾è¡¨**ï¼šæ”¯æŒæ‚¬åœæŸ¥çœ‹è¯¦ç»†æ•°æ®

### ğŸš€ æŠ€æœ¯ç‰¹æ€§
- **æ™ºèƒ½é¢„åŠ è½½**ï¼šä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œæå‰åŠ è½½å¯èƒ½è®¿é—®çš„é¡µé¢
- **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **å®æ—¶æ•°æ®æ›´æ–°**ï¼šä½¿ç”¨ React Hooks è¿›è¡ŒçŠ¶æ€ç®¡ç†
- **äº‘ç«¯å­˜å‚¨**ï¼šé›†æˆ Cloudflare R2 å¯¹è±¡å­˜å‚¨æœåŠ¡
- **HEIC æ”¯æŒ**ï¼šè‡ªåŠ¨è½¬æ¢è‹¹æœè®¾å¤‡çš„ HEIC æ ¼å¼ç…§ç‰‡

### ğŸ’¾ æ•°æ®æŒä¹…åŒ–
- **PostgreSQL æ•°æ®åº“**ï¼šä½¿ç”¨ Neon äº‘æ•°æ®åº“æœåŠ¡
- **Prisma ORM**ï¼šç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ

## ğŸ”§ æŠ€æœ¯æ ˆ
- **å‰ç«¯æ¡†æ¶**ï¼šNext.js 15 + React 19
- **ç±»å‹ç³»ç»Ÿ**ï¼šTypeScript
- **æ ·å¼æ¡†æ¶**ï¼šTailwind CSS
- **æ•°æ®åº“ ORM**ï¼šPrisma
- **äº‘æ•°æ®åº“**ï¼šNeon (PostgreSQL)
- **çŠ¶æ€ç®¡ç†**ï¼šReact Hooks + Custom Hooks
- **éƒ¨ç½²å¹³å°**ï¼šVercel (æ¨è)/ local
- **å¯¹è±¡å­˜å‚¨**: Cloudflare R2
- **å›¾è¡¨åº“**ï¼šRecharts
- **æ–‡ä»¶å¤„ç†**ï¼šSharp (å›¾ç‰‡å¤„ç†)ã€FFmpeg (è§†é¢‘å¤„ç†)

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- Node.js 18.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- npm æˆ– yarn åŒ…ç®¡ç†å™¨
- PostgreSQL æ•°æ®åº“ï¼ˆæ¨èä½¿ç”¨ Neonï¼‰
- Cloudflare R2 è´¦å·ï¼ˆç”¨äºæ–‡ä»¶å­˜å‚¨ï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/zhajiahe/my-baby.git
cd my-baby
```

### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

### 3. ç¯å¢ƒé…ç½®
å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿å¹¶é…ç½®ï¼š
```bash
cp env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
```env
# æ•°æ®åº“è¿æ¥
DATABASE_URL="your_neon_database_url"

# Cloudflare R2 é…ç½®
R2_TOKEN="your_r2_token"
R2_ACCESS_KEY_ID="your_access_key_id"
R2_SECRET_ACCESS_KEY="your_secret_access_key"
R2_ENDPOINT="your_r2_endpoint"
R2_PUBLIC_DOMAIN="your_public_domain"
R2_ACCOUNT_ID="your_account_id"
R2_BUCKET_NAME="your_bucket_name"
```

### 4. æ•°æ®åº“è®¾ç½®
```bash
# ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npm run db:generate

# æ¨é€æ•°æ®åº“ç»“æ„
npm run db:push

# ï¼ˆå¯é€‰ï¼‰å¡«å……åˆå§‹æ•°æ®
npm run db:seed
```

### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨ã€‚

## ğŸ“ å¯ç”¨è„šæœ¬

- `npm run dev` - å¯åŠ¨å¼€å‘æœåŠ¡å™¨
- `npm run build` - æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- `npm run start` - å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
- `npm run lint` - è¿è¡Œä»£ç æ£€æŸ¥
- `npm run db:generate` - ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
- `npm run db:push` - æ¨é€æ•°æ®åº“ç»“æ„å˜æ›´
- `npm run db:studio` - æ‰“å¼€ Prisma Studio æ•°æ®åº“ç®¡ç†ç•Œé¢
- `npm run db:seed` - å¡«å……åˆå§‹æ•°æ®
- `npm run db:reset` - é‡ç½®æ•°æ®åº“å¹¶å¡«å……åˆå§‹æ•°æ®

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ baby/          # å®å®ä¿¡æ¯ API
â”‚   â”‚   â”œâ”€â”€ growth-records/ # æˆé•¿è®°å½• API
â”‚   â”‚   â”œâ”€â”€ milestones/    # é‡Œç¨‹ç¢‘ API
â”‚   â”‚   â””â”€â”€ photos/        # ç…§ç‰‡ä¸Šä¼  API
â”‚   â”œâ”€â”€ components/        # é¡µé¢çº§ç»„ä»¶
â”‚   â””â”€â”€ globals.css        # å…¨å±€æ ·å¼
â”œâ”€â”€ components/            # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ ui/               # UI åŸºç¡€ç»„ä»¶
â”‚   â””â”€â”€ providers/        # Context æä¾›è€…
â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰ React Hooks
â””â”€â”€ lib/                  # å·¥å…·å‡½æ•°å’Œé…ç½®
prisma/
â”œâ”€â”€ schema.prisma         # æ•°æ®åº“æ¨¡å¼
â””â”€â”€ seed.ts              # æ•°æ®åº“ç§å­æ–‡ä»¶
```

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®
é¡¹ç›®ä½¿ç”¨ PostgreSQL æ•°æ®åº“ï¼Œæ¨èä½¿ç”¨ [Neon](https://neon.tech) äº‘æ•°æ®åº“æœåŠ¡ã€‚æ•°æ®æ¨¡å‹åŒ…æ‹¬ï¼š
- `Baby` - å®å®åŸºæœ¬ä¿¡æ¯
- `GrowthRecord` - æˆé•¿è®°å½•
- `Milestone` - é‡Œç¨‹ç¢‘è®°å½•
- `MediaItem` - åª’ä½“æ–‡ä»¶è®°å½•

### å­˜å‚¨é…ç½® (å‰ææ˜¯æœ‰ä¸€ä¸ªå…¬å…±åŸŸåï¼Œæ‰èƒ½å®ç°å›¾åƒ/è§†é¢‘å…¬å¼€è®¿é—®)
ä½¿ç”¨ Cloudflare R2 è¿›è¡Œæ–‡ä»¶å­˜å‚¨ï¼Œæ”¯æŒï¼š
- å›¾ç‰‡è‡ªåŠ¨å‹ç¼©å’Œæ ¼å¼è½¬æ¢
- HEIC æ ¼å¼è‡ªåŠ¨è½¬æ¢ä¸º JPEG
- è§†é¢‘ç¼©ç•¥å›¾ç”Ÿæˆ
- é¢„ç­¾å URL å®‰å…¨ä¸Šä¼ 

### ğŸ“¦ Cloudflare R2 é…ç½®æŒ‡å—

#### 1. åˆ›å»º Cloudflare è´¦å·
è®¿é—® [Cloudflare Dashboard](https://dash.cloudflare.com/) å¹¶åˆ›å»ºè´¦å·

#### 2. åˆ›å»º R2 å­˜å‚¨æ¡¶
1. åœ¨ Cloudflare Dashboard ä¸­ï¼Œé€‰æ‹© **R2 Object Storage**
2. ç‚¹å‡» **Create bucket** åˆ›å»ºæ–°çš„å­˜å‚¨æ¡¶
3. è¾“å…¥å­˜å‚¨æ¡¶åç§°ï¼ˆä¾‹å¦‚ï¼š`my-baby-photos`ï¼‰
4. é€‰æ‹©åˆé€‚çš„ä½ç½®ï¼ˆæ¨èé€‰æ‹©ç¦»ç”¨æˆ·æœ€è¿‘çš„åŒºåŸŸï¼‰
5. ç‚¹å‡» **Create bucket**

#### 3. ç”Ÿæˆ API ä»¤ç‰Œ
1. åœ¨ Cloudflare Dashboard ä¸­ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·å¤´åƒ
2. é€‰æ‹© **My Profile** > **API Tokens**
3. ç‚¹å‡» **Create Token**
4. é€‰æ‹© **Custom token** æ¨¡æ¿
5. é…ç½®æƒé™ï¼š
   - **Account** - `Cloudflare R2:Edit`
   - **Zone Resources** - é€‰æ‹©ä½ çš„è´¦å·
6. ç‚¹å‡» **Continue to summary** ç„¶å **Create Token**
7. **é‡è¦**ï¼šå¤åˆ¶å¹¶å®‰å…¨ä¿å­˜ç”Ÿæˆçš„ä»¤ç‰Œ

#### 4. è·å– R2 API å‡­æ®
1. å›åˆ° R2 Overview é¡µé¢
2. åœ¨å³ä¾§è¾¹æ ç‚¹å‡» **Manage R2 API tokens**
3. ç‚¹å‡» **Create API token**
4. é…ç½®æƒé™ï¼š
   - **Permissions**: `Admin Read & Write`
   - **Specify bucket**: é€‰æ‹©ä½ åˆ›å»ºçš„å­˜å‚¨æ¡¶
5. ç‚¹å‡» **Create API token**
6. å¤åˆ¶ **Access Key ID** å’Œ **Secret Access Key**

#### 5. é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ä½†æ¨èï¼‰
1. åœ¨å­˜å‚¨æ¡¶è¯¦æƒ…é¡µé¢ï¼Œç‚¹å‡» **Settings** æ ‡ç­¾
2. åœ¨ **Public access** éƒ¨åˆ†ï¼Œç‚¹å‡» **Connect Domain**
3. è¾“å…¥ä½ çš„è‡ªå®šä¹‰åŸŸåï¼ˆä¾‹å¦‚ï¼š`cdn.yourdomain.com`ï¼‰
4. æŒ‰ç…§è¯´æ˜åœ¨ä½ çš„ DNS æä¾›å•†å¤„æ·»åŠ  CNAME è®°å½•
5. ç­‰å¾… DNS ä¼ æ’­å®Œæˆï¼ˆé€šå¸¸éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰

#### 6. ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
```env
# ä» R2 API tokens é¡µé¢è·å–
R2_ACCESS_KEY_ID="your_access_key_id_here"
R2_SECRET_ACCESS_KEY="your_secret_access_key_here"

# ä»ä½ çš„è´¦å·ä¿¡æ¯è·å–
R2_ACCOUNT_ID="your_cloudflare_account_id"

# ä½ åˆ›å»ºçš„å­˜å‚¨æ¡¶åç§°
R2_BUCKET_NAME="my-baby-photos"

# R2 ç«¯ç‚¹æ ¼å¼
R2_ENDPOINT="https://your_account_id.r2.cloudflarestorage.com"

# ä½ é…ç½®çš„è‡ªå®šä¹‰åŸŸåï¼ˆå¦‚æœæœ‰ï¼‰
R2_PUBLIC_DOMAIN="https://cdn.yourdomain.com"

# API ä»¤ç‰Œï¼ˆä»æ­¥éª¤3è·å–ï¼‰
R2_TOKEN="your_api_token_here"
```


## ğŸš€ éƒ¨ç½²

### Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰
1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²å®Œæˆ

### æœ¬åœ°éƒ¨ç½²
```bash
npm run build
npm run start
```

## ğŸ“„ License

This project is licensed under the MIT License.